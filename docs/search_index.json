[
["fisher-wright.html", "Chapter 9 Fisher-Wright 9.1 Outline 9.2 Parallel 9.3 Questions we can ask 9.4 Path to fixation: a measure of homogeneity/heterogeneity 9.5 Baby Names 9.6 Conclusions", " Chapter 9 Fisher-Wright 9.1 Outline -Example 9.2 Parallel .column-left{ float: left; width: 50%; text-align: left; } .column-right{ float: right; width: 50%; text-align: left; } Fisher-Wright Children picking their parents (not generative'') \\item Total population size is constant \\item Qualitatively similar to BP. Extinction and fixation. \\item Flexible: mutation, selection, even changes in pop size. \\item With apologies, biologists take FWseriously’’ even if they don’t take it ``literally.’’ Galton-Watson-Bienaym'e Branching Processe Branching process models independent parents randomly producing offspring. Generative'' \\item Total population size can vary, and has a random component and deterministic one $m$ \\item Qualitative result when $m = 1$ is that there is one longest surviving line. This isfixation’’, when one {} becomes universal. 9.2.1 Another cell phone example Let’s simulate and draw lines Gen 1 0 1 2 3 4 5 6 7 8 9 Gen 2 Gen 3 What will happen? Simulation code fwm &lt;- function(N, n_gen, mu = 0) ## mu != 4/N { ## simulate fisher-wright (with mutations) x &lt;- paste(1:N) ## starting types A &lt;- matrix(NA, nrow = n_gen, ncol = N) for (i in 1:n_gen) { A[i,] &lt;- x x &lt;- sample(x, size = N, replace = T) x &lt;- mut(x, mu) x } return(A) ## matrix of types, each line a generation. } mut &lt;- function(x, mu) { ## m, the individuals that mutate m &lt;- which(rbinom(length(x), 1, mu) == 1) if (length(m) == 0) ## if no-one mutates return(x) ## add a suffix to their ID, so it will be unique (infinite alleles) suffix &lt;- 10000*round(runif(length(m)),4) x[m] &lt;- paste0(x[m], &quot;.&quot;, suffix) x } Trying it out set.seed(1) fwm(N = 10, n_gen = 2, mu = 0) ## [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] ## [1,] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; &quot;5&quot; &quot;6&quot; &quot;7&quot; &quot;8&quot; &quot;9&quot; &quot;10&quot; ## [2,] &quot;9&quot; &quot;4&quot; &quot;7&quot; &quot;1&quot; &quot;2&quot; &quot;7&quot; &quot;2&quot; &quot;3&quot; &quot;1&quot; &quot;5&quot; fwm(N = 10, n_gen = 2, mu = 0) ## [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] ## [1,] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; &quot;5&quot; &quot;6&quot; &quot;7&quot; &quot;8&quot; &quot;9&quot; &quot;10&quot; ## [2,] &quot;5&quot; &quot;5&quot; &quot;2&quot; &quot;10&quot; &quot;9&quot; &quot;1&quot; &quot;4&quot; &quot;3&quot; &quot;6&quot; &quot;10&quot; Trying it out some more set.seed(1) A &lt;- fwm(N = 10, n_gen = 20, mu = 0) tt &lt;- table(A, row(A)) ## count types by row ptt &lt;- prop.table(tt, 2) ## proportions matplot(t(ptt), type = &#39;l&#39;, lty = 1, main = &quot;FW simu&quot;) text(x = 4, y = jitter(ptt[,4]), rownames(ptt), col = 1:6) Qs: What happens at time 15? Why does line 5 rise and fall? What happens at time 2? What is \\(E(p_i(t) | p_i(t-1))\\)? Bigger pop and more time set.seed(1) A &lt;- fwm(N = 100, n_gen = 200, mu = 0) tt &lt;- table(A, row(A)) ## count types by row ptt &lt;- prop.table(tt, 2) ## proportions matplot(t(ptt), type = &#39;l&#39;, lty = 1) What does this remind you of? What will happen in long run? What other questions could we ask? 9.3 Questions we can ask What is probability that line \\(i\\) will ``fix’’? (Hint: easy) What is expected time until some line fixes? (We’ll demo the result) How can we describe the path to fixation? (We’ll derive the result) 9.3.1 Probability that a particular line will “fix” set.seed(1) A &lt;- fwm(N = 10, n_gen = 20, mu = 0) tt &lt;- table(A, row(A)) ## count types by row ptt &lt;- prop.table(tt, 2) ## proportions matplot(t(ptt), type = &#39;l&#39;, lty = 1, main = &quot;FW simu&quot;) text(x = 4, y = jitter(ptt[,4]), rownames(ptt), col = 1:6) ### Expected time until fixation? Answer for us is \\[ \\bar{T}_{fixed} = 2 \\cdot N \\] Note: Biologists say \\(4 N_e\\) \\ See Wikipedia “Genetic drift” 9.3.2 Simulation of time to fixation T.vec &lt;- NULL all.the.same &lt;- function(x){length(unique(x)) == 1} set.seed(10) for (i in 1:100) { A &lt;- fwm(N = 100, n_gen = 1000,mu = 0) extinction_time = min(row(A)[apply(A, 1, all.the.same)]) T.vec[i] &lt;- extinction_time } mean(T.vec) ## [1] 202.89 9.4 Path to fixation: a measure of homogeneity/heterogeneity Chance that two randomly drawn individuals are of same type. \\[ G = \\sum_i p_i^2 \\] If we have two types, \\(p_1 = \\pi\\) , \\(p_2 = 1-\\pi\\)? What is G if \\(\\pi = 0, .5, 1\\)? Let’s derive time path of G Let’s assume just two types, \\(\\pi(t)\\) Chance two indiv are of same type \\[ G_{t+1} = P(\\mbox{same parent})\\cdot 1 + P(\\mbox{different parent})\\cdot G_{t} \\] Notation: I’m going use \\(K\\) for pop size. Bio uses \\(2N\\). \\[ G_{t+1} = {1 \\over K} \\cdot 1 + (1 - {1\\over K}) \\cdot G_{t} \\] Easier to solve letting \\(H = 1 - G\\). Some algebra gives \\[ H_{t+1} = H_{t} (1 - 1/K) \\] Or, \\[ H_{t} = H_0 (1 - 1/K)^t % \\rightarrow H_0 e^{-t/K} \\] So, H goes to 0 exponentially, just as G goes to 1. 9.5 Baby Names “Drift as a mechanism for cultural change: an example from baby names” by Matthew W. Hahn and R. Alexander Bentley &gt; Proc. R. Soc. Lond. B 2003 270, S120-S123 What’s the basic idea? How is naming a baby like Fisher-Wright? How is it not? Like Fisher-Wright people choose from existing set (?) names are ``neutral’’ (?) draw proportionally (?) They test to see if they can reject FW compare observed histograms to FW simulation They include mutation to get a stationary disn Note: failing to reject FW doesn’t mean it’s correct Their picture &gt; &gt; 9.5.1 Drawing their picture with the data babynames.R 9.5.2 Some potential criticism While we can’t reject that there’s some parameterization of FW that gives us similar disn, this doesn’t mean that we’ve found the right mechanism. (Just that we can’t reject it). What are some other tests of this mechanism? Markov assumption. We could see if each frequency really followed random walk. Perhaps we could see if variances were scaled to frequencies correctly. 9.6 Conclusions Fisher-Wright an alternative to branching processes It reverses logic of reproduction, but gives similar quantitative and qualitative results A neutral model for other processes? Starting point for coalescent "]
]
