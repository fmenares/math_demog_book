<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>07-branching.utf8</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown #bookdown:version# and GitBook 2.6.7" />

  <meta property="og:title" content="07-branching.utf8" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="07-branching.utf8" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



<!--bookdown:title:start-->
<!--bookdown:title:end-->

<!--bookdown:toc:start-->
  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">
<!--bookdown:toc2:start-->
<ul>
<li><a href="#branching-processes"><span class="toc-section-number">1</span> Branching Processes</a></li>
<li><a href="#outline"><span class="toc-section-number">2</span> Outline</a></li>
<li><a href="#branching-process"><span class="toc-section-number">3</span> Branching Process</a><ul>
<li><a href="#stochastic-modeling"><span class="toc-section-number">3.1</span> Stochastic modeling</a></li>
<li><a href="#why-are-we-interested"><span class="toc-section-number">3.2</span> Why are we interested?</a><ul>
<li><a href="#very-brief-history-of-branching-processes"><span class="toc-section-number">3.2.1</span> Very brief history of Branching Processes</a></li>
<li><a href="#applicability-to-the-coronavirus-yes-and-no."><span class="toc-section-number">3.2.2</span> Applicability to the Coronavirus? Yes and no.</a></li>
</ul></li>
<li><a href="#simulated-examples-and-the-questions-they-raise"><span class="toc-section-number">3.3</span> Simulated examples and the questions they raise</a><ul>
<li><a href="#our-viral-example"><span class="toc-section-number">3.3.1</span> Our viral example</a></li>
</ul></li>
<li><a href="#what-is-a-bienayme-galton-watson-branching-process"><span class="toc-section-number">3.4</span> What is a (Bienaym'e-)Galton-Watson branching process?</a><ul>
<li><a href="#some-questions"><span class="toc-section-number">3.4.1</span> Some questions</a></li>
<li><a href="#galtons-original-question"><span class="toc-section-number">3.4.2</span> Galton’s original question</a></li>
<li><a href="#a-simulation"><span class="toc-section-number">3.4.3</span> A simulation</a></li>
<li><a href="#a-simulation-2"><span class="toc-section-number">3.4.4</span> A simulation (2)</a></li>
<li><a href="#a-simulation-3"><span class="toc-section-number">3.4.5</span> A simulation (3)</a></li>
<li><a href="#extinction-vsbreakout"><span class="toc-section-number">3.4.6</span> <code>Extinction'' vs</code>breakout’’</a></li>
</ul></li>
<li><a href="#mathematical-analysis"><span class="toc-section-number">3.5</span> Mathematical Analysis</a><ul>
<li><a href="#the-probability-generating-function-our-mathematical-tool"><span class="toc-section-number">3.5.1</span> The Probability Generating Function: Our mathematical tool</a></li>
<li><a href="#the-story-of-two-brothers"><span class="toc-section-number">3.5.2</span> The story of two brothers</a></li>
</ul></li>
<li><a href="#extinction"><span class="toc-section-number">3.6</span> Extinction</a></li>
<li><a href="#return-to-our-simulation"><span class="toc-section-number">3.7</span> Return to our simulation</a><ul>
<li><a href="#means-and-variances-of-z_n"><span class="toc-section-number">3.7.1</span> Means and variances of <span class="math inline">\(Z_n\)</span>}</a></li>
<li><a href="#convergence-of-z_n-mn-to-random-variable-w"><span class="toc-section-number">3.7.2</span> Convergence of <span class="math inline">\(Z_n / m^n\)</span> to random variable <span class="math inline">\(W\)</span>}</a></li>
</ul></li>
<li><a href="#good-and-bad-set-ups-for-branching-process"><span class="toc-section-number">3.8</span> Good and bad set-ups for branching process</a></li>
</ul></li>
</ul>
<!--bookdown:toc2:end-->
      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:toc:end-->
<!--bookdown:body:start-->
<div id="branching-processes" class="section level1">
<h1><span class="header-section-number">1</span> Branching Processes</h1>
</div>
<div id="outline" class="section level1">
<h1><span class="header-section-number">2</span> Outline</h1>
<ul>
<li>The Galton-Watson-Bienaym'e Process</li>
<li>A viral example, simulating a branching process, our questionsThe distribution of the 2nd generation</li>
<li>Moment generating functions</li>
<li>Extinction probabilities</li>
<li>The distribution of offspring of all generations</li>
<li>A tractable offspring distribution</li>
</ul>
</div>
<div id="branching-process" class="section level1">
<h1><span class="header-section-number">3</span> Branching Process</h1>
<div id="stochastic-modeling" class="section level2">
<h2><span class="header-section-number">3.1</span> Stochastic modeling</h2>
<ul>
<li>Until now, we’ve focused on the hidden structures of
heterogeneity.</li>
<li>Now, we’re switching gears:</li>
<li>Stochastic not deterministic</li>
<li>In small populations, randomness matters. (Even when risks are homogeneous.)</li>
<li>branching processes (<code>parents producing children''), next     Fisher-Wright (</code>children choosing parents’‘), and then historical
reconstruction from contemporary diversity (``coalescent’’).</li>
</ul>
</div>
<div id="why-are-we-interested" class="section level2">
<h2><span class="header-section-number">3.2</span> Why are we interested?</h2>
<div id="very-brief-history-of-branching-processes" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Very brief history of Branching Processes</h3>
<ul>
<li>Bienayme’s lost notes</li>
<li>Galton and Watson’s (extinction of families)
old motivation: to see if elites were dying out because of
``degeneration’’</li>
<li>Genetics (survival of a mutant)
<ul>
<li>contemporary motivation: evolution and neutral genetic
change. what is the chance that a mutant will survive?</li>
</ul></li>
<li>The bomb (chain reactions)
<ul>
<li>war-time motivation: to see how to build the bomb</li>
</ul></li>
<li><p>Anywhere ``incipient dynamics’’ matter.</p>
<ul>
<li>sociological: will all of S. Korea be ``Kim’’?</li>
</ul></li>
<li>can we get variance of repro success from name disn?</li>
<li><p>it will give us a headstart on other (less realistic but easier) ``drift’’ models.</p></li>
</ul>
</div>
<div id="applicability-to-the-coronavirus-yes-and-no." class="section level3">
<h3><span class="header-section-number">3.2.2</span> Applicability to the Coronavirus? Yes and no.</h3>
<ul>
<li>Perhaps the beginning, with first few cases.</li>
<li>But once scale gets large, we’ll see that deterministic
dynamics take over.</li>
<li>One lesson: beyond <span class="math inline">\(R_0\)</span>.</li>
</ul>
</div>
</div>
<div id="simulated-examples-and-the-questions-they-raise" class="section level2">
<h2><span class="header-section-number">3.3</span> Simulated examples and the questions they raise</h2>
<div id="our-viral-example" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Our viral example</h3>
<p>Here are the chances that the first carrier passes on the virus to <span class="math inline">\(k\)</span>
people?</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">phone_table &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">0</span>,.<span class="dv">3</span>,<span class="st">&quot;0-2&quot;</span>),</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">               <span class="kw">c</span>(<span class="dv">1</span>,.<span class="dv">4</span>,<span class="st">&quot;3-5&quot;</span>),</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">               <span class="kw">c</span>(<span class="dv">2</span>,.<span class="dv">3</span>,<span class="st">&quot;6-9&quot;</span>))</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw">colnames</span>(phone_table) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;k&quot;</span>,<span class="st">&quot;p_k&quot;</span>,<span class="st">&quot;digits&quot;</span>)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">knitr<span class="op">::</span><span class="kw">kable</span>(</a>
<a class="sourceLine" id="cb1-6" data-line-number="6">  phone_table, <span class="dt">booktabs =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb1-7" data-line-number="7">  <span class="dt">caption =</span> <span class="st">&#39;A table of the first 10 rows of the mtcars data.&#39;</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8">)</a></code></pre></div>
<table>
<caption>(#tab:unnamed-chunk-1)A table of the first 10 rows of the mtcars data.</caption>
<thead>
<tr class="header">
<th align="left">k</th>
<th align="left">p_k</th>
<th align="left">digits</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">0</td>
<td align="left">0.3</td>
<td align="left">0-2</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">0.4</td>
<td align="left">3-5</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td align="left">0.3</td>
<td align="left">6-9</td>
</tr>
</tbody>
</table>
<ul>
<li>What is <span class="math inline">\(R_0\)</span>, (aka <span class="math inline">\(m\)</span>)? Calculate.</li>
<li>Let’s diagram one chance outcome, using my number ``(xxx) xxx-9056’’</li>
</ul>
\begin{frame}[fragile]{Let’s repeat}

</div>
</div>
<div id="what-is-a-bienayme-galton-watson-branching-process" class="section level2">
<h2><span class="header-section-number">3.4</span> What is a (Bienaym'e-)Galton-Watson branching process?</h2>
<p>-[<span class="math inline">\(p_k\)</span>] Each individual in each generation reproduces
independently, following same offspring distribution, with <span class="math inline">\(p_k\)</span>
as the probability of having <span class="math inline">\(k\)</span> offspring.
-[<span class="math inline">\(Z_n\)</span>] The si<span class="math inline">\(Z\)</span>e of the <span class="math inline">\(n\)</span>’th generation <span class="math inline">\(Z_n\)</span>. (<span class="math inline">\(Z_1 \equiv 1\)</span>)
-[<span class="math inline">\(p_0 &gt; 0\)</span>] Some non-zero probability of no children.
-[Variance] None of the <span class="math inline">\(p_k\)</span> are 1</p>
<div id="some-questions" class="section level3">
<h3><span class="header-section-number">3.4.1</span> Some questions</h3>
<ul>
<li>What is the chance <span class="math inline">\(d\)</span> of eventual extinction (no ``outbreak’’)?</li>
<li>Or, what is the distribution of surviving family
sizes?</li>
<li>What are the aggregate properties of many branching
processes? (Mean growth, variance, time-paths, eventual size)?</li>
</ul>
</div>
<div id="galtons-original-question" class="section level3">
<h3><span class="header-section-number">3.4.2</span> Galton’s original question</h3>
<pre><code>% \caption{A simulation of heterogeneous growth}
\centering
\includegraphics[width = 1.0\textwidth]{./galton_title}\\
\includegraphics[width = 1.0\textwidth]{./galton_quote}\\
\includegraphics[width = 1.0\textwidth]{./galton_quote_more}</code></pre>
</div>
<div id="a-simulation" class="section level3">
<h3><span class="header-section-number">3.4.3</span> A simulation</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">  k =<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">  p0 =<span class="st"> </span><span class="fl">.3</span>; p1 =<span class="st"> </span><span class="fl">.3</span>; p2 =<span class="st"> </span><span class="fl">.4</span>;</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">  p_k =<span class="st"> </span><span class="kw">c</span>(p0, p1, p2)</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">  Z1 =<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5">  <span class="kw">set.seed</span>(<span class="dv">9</span>)</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">  (<span class="dt">kids.of.Z1 =</span> <span class="kw">sample</span>(<span class="dt">x =</span> k, <span class="dt">size =</span> Z1, <span class="dt">replace =</span> T, <span class="dt">prob =</span> p_k))</a></code></pre></div>
<pre><code>## [1] 2</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">  (<span class="dt">Z2 =</span> <span class="kw">sum</span>(kids.of.Z1))</a></code></pre></div>
<pre><code>## [1] 2</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">  (<span class="dt">kids.of.Z2 =</span> <span class="kw">sample</span>(<span class="dt">x =</span> k, <span class="dt">size =</span> Z2, <span class="dt">replace =</span> T, <span class="dt">prob =</span> p_k))</a></code></pre></div>
<pre><code>## [1] 2 2</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">  (<span class="dt">Z3 =</span> <span class="kw">sum</span>(kids.of.Z2))</a></code></pre></div>
<pre><code>## [1] 4</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">  (<span class="dt">kids.of.Z3 =</span> <span class="kw">sample</span>(<span class="dt">x =</span> k, <span class="dt">size =</span> Z3, <span class="dt">replace =</span> T, <span class="dt">prob =</span> p_k))</a></code></pre></div>
<pre><code>## [1] 2 1 2 2</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">  (<span class="dt">Z4 =</span> <span class="kw">sum</span>(kids.of.Z3))</a></code></pre></div>
<pre><code>## [1] 7</code></pre>
<p>Let’s draw the tree.</p>
</div>
<div id="a-simulation-2" class="section level3">
<h3><span class="header-section-number">3.4.4</span> A simulation (2)</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">  <span class="co">#A function   </span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2">  branch &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">n_max =</span> <span class="dv">30</span>, <span class="dt">pk =</span> <span class="kw">c</span>(p0, p1, p2), <span class="dt">Z1 =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb15-3" data-line-number="3">  {</a>
<a class="sourceLine" id="cb15-4" data-line-number="4">      Z.vec &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, n_max)</a>
<a class="sourceLine" id="cb15-5" data-line-number="5">      Z.vec[<span class="dv">1</span>] &lt;-<span class="st"> </span>Z1</a>
<a class="sourceLine" id="cb15-6" data-line-number="6">      <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(n_max<span class="dv">-1</span>))</a>
<a class="sourceLine" id="cb15-7" data-line-number="7">      {</a>
<a class="sourceLine" id="cb15-8" data-line-number="8">          Z.vec[i<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="kw">sample</span>(<span class="dt">x =</span> k,</a>
<a class="sourceLine" id="cb15-9" data-line-number="9">                                   <span class="dt">size =</span> Z.vec[i],</a>
<a class="sourceLine" id="cb15-10" data-line-number="10">                                   <span class="dt">replace =</span> T,</a>
<a class="sourceLine" id="cb15-11" data-line-number="11">                                   <span class="dt">prob =</span> p_k))</a>
<a class="sourceLine" id="cb15-12" data-line-number="12">      }</a>
<a class="sourceLine" id="cb15-13" data-line-number="13">      <span class="kw">return</span>(Z.vec)</a>
<a class="sourceLine" id="cb15-14" data-line-number="14">  }</a>
<a class="sourceLine" id="cb15-15" data-line-number="15">  <span class="kw">set.seed</span>(<span class="dv">19</span>); <span class="kw">branch</span>()</a></code></pre></div>
<pre><code>##  [1] 1 2 2 4 5 2 2 3 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">  <span class="kw">set.seed</span>(<span class="dv">99</span>);   <span class="kw">branch</span>()</a></code></pre></div>
<pre><code>##  [1] 1 1 2 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</code></pre>
</div>
<div id="a-simulation-3" class="section level3">
<h3><span class="header-section-number">3.4.5</span> A simulation (3)</h3>
<p>Let’s see what happens with 20 trials (up to 30 generations)</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">  n_trials =<span class="st"> </span><span class="dv">20</span>; n_gen =<span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2">  Z.mat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, n_trials, n_gen)</a>
<a class="sourceLine" id="cb19-3" data-line-number="3">  <span class="kw">set.seed</span>(<span class="dv">131</span>)</a>
<a class="sourceLine" id="cb19-4" data-line-number="4">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n_trials)</a>
<a class="sourceLine" id="cb19-5" data-line-number="5">      Z.mat[i,] &lt;-<span class="st"> </span><span class="kw">branch</span>(<span class="dt">n_max =</span> n_gen)</a>
<a class="sourceLine" id="cb19-6" data-line-number="6">  <span class="kw">matplot</span>(<span class="kw">t</span>(Z.mat),</a>
<a class="sourceLine" id="cb19-7" data-line-number="7">          <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">ylab =</span> <span class="st">&quot;Zn&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;n&quot;</span>)</a></code></pre></div>
<p><img src="07-branching_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">  n_trials =<span class="st"> </span><span class="dv">20</span>; n_gen =<span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb20-2" data-line-number="2">  Z.mat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, n_trials, n_gen)</a>
<a class="sourceLine" id="cb20-3" data-line-number="3">  <span class="kw">set.seed</span>(<span class="dv">131</span>) </a>
<a class="sourceLine" id="cb20-4" data-line-number="4">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n_trials)</a>
<a class="sourceLine" id="cb20-5" data-line-number="5">      Z.mat[i,] &lt;-<span class="st"> </span><span class="kw">branch</span>(<span class="dt">n_max =</span> n_gen)</a>
<a class="sourceLine" id="cb20-6" data-line-number="6">  <span class="kw">matplot</span>(<span class="kw">t</span>(Z.mat),</a>
<a class="sourceLine" id="cb20-7" data-line-number="7">          <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">ylab =</span> <span class="st">&quot;Zn&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;n&quot;</span>)</a></code></pre></div>
<p><img src="07-branching_files/figure-html/unnamed-chunk-5-1.png" width="672" />
How many survive (out of 20)?</p>
<p>log-scale</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">  <span class="kw">suppressWarnings</span>(<span class="kw">matplot</span>(<span class="kw">t</span>(Z.mat), <span class="dt">log =</span> <span class="st">&quot;y&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">ylab =</span> <span class="st">&quot;Zn&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;n&quot;</span>))</a></code></pre></div>
<p><img src="07-branching_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">  surviving =<span class="st"> </span><span class="kw">ifelse</span>(Z.mat[,n_gen] <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="st">&quot;extinct&quot;</span>, <span class="st">&quot;survive&quot;</span>)</a>
<a class="sourceLine" id="cb22-2" data-line-number="2">  foo &lt;-<span class="st"> </span><span class="kw">prop.table</span>(<span class="kw">table</span>(surviving))</a>
<a class="sourceLine" id="cb22-3" data-line-number="3"></a>
<a class="sourceLine" id="cb22-4" data-line-number="4">  <span class="kw">print</span>( <span class="kw">prop.table</span>(<span class="kw">table</span>(surviving)) )</a></code></pre></div>
<pre><code>## surviving
## extinct survive 
##     0.5     0.5</code></pre>
<ul>
<li>How would you discribe the time path of the surviving lines?</li>
</ul>
<p>Long term</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1">  n_trials =<span class="st"> </span><span class="dv">20</span>; n_gen =<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb24-2" data-line-number="2">  Z.mat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, n_trials, n_gen)</a>
<a class="sourceLine" id="cb24-3" data-line-number="3">  <span class="kw">set.seed</span>(<span class="dv">131</span>) </a>
<a class="sourceLine" id="cb24-4" data-line-number="4">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n_trials)</a>
<a class="sourceLine" id="cb24-5" data-line-number="5">      Z.mat[i,] &lt;-<span class="st"> </span><span class="kw">branch</span>(<span class="dt">n_max =</span> n_gen)</a>
<a class="sourceLine" id="cb24-6" data-line-number="6">  <span class="kw">suppressWarnings</span>(<span class="kw">matplot</span>(<span class="kw">t</span>(Z.mat), <span class="dt">log =</span> <span class="st">&quot;y&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">ylab =</span> <span class="st">&quot;Zn&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;n&quot;</span>))</a></code></pre></div>
<p><img src="07-branching_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>What does this remind you of? (Hint: ``Leslie’’). (See Harris figure)</p>
</div>
<div id="extinction-vsbreakout" class="section level3">
<h3><span class="header-section-number">3.4.6</span> <code>Extinction'' vs</code>breakout’’</h3>
<ul>
<li>We see that in a super-critical (<span class="math inline">\(m &gt; 1\)</span>) branching process,
if a line can survive a few generations and reach a large enough
size, it will grow exponentially.</li>
<li>What happens if <span class="math inline">\(m &lt; 1\)</span>, if <span class="math inline">\(m = 1\)</span>? Discuss.</li>
</ul>
</div>
</div>
<div id="mathematical-analysis" class="section level2">
<h2><span class="header-section-number">3.5</span> Mathematical Analysis</h2>
<div id="the-probability-generating-function-our-mathematical-tool" class="section level3">
<h3><span class="header-section-number">3.5.1</span> The Probability Generating Function: Our mathematical tool</h3>
<p><span class="math display">\[
  h(z) = p_0 + p_1 z + p_2 z^2 + \ldots
  \]</span></p>
<p>The PGF ``keeps book’’ on the probabilities. The
chance of <span class="math inline">\(k\)</span> is the coefficient on <span class="math inline">\(z^k\)</span>.</p>
<p>-[$h(0) = $ ]
-[$h(1) = $ ]
-[$h’(1) = $]</p>
<p>But the magic is next.</p>
</div>
<div id="the-story-of-two-brothers" class="section level3">
<h3><span class="header-section-number">3.5.2</span> The story of two brothers</h3>
<p>A father has two sons. The probability generating function of their
children combined is:</p>
<p><span class="math display">\[
  [h(z)]^2 = (p_0  + p_1 z + p_2 z^2) \times (p_0  + p_1 z + p_2 z^2)
  \]</span></p>
<p>Multiply out, and tell me the coefficients on $z^0, z^1, $.</p>
<p>Even more amazing</p>
<p>What is the probability generating function for the distribution of grandsons?</p>
<ul>
<li>A man has two sons, with probability <span class="math inline">\(p_2\)</span>, so PGF in that case
is $ p_2 [h(z)]^2 $.</li>
<li><p>But let’s sum over all possible numbers of
sons.</p>
<p><span class="math display">\[
p_0 + p_1 h(z) + p_2 [h(z)]^2 + p_3 [h(z)]^3 + \ldots
\]</span></p></li>
<li><p>Which is? (Hint: write a new argument for PGF)
<span class="math display">\[
h(h(z))
\]</span></p></li>
<li><p>Can show PGF for the n’th generation is
<span class="math display">\[
h(h(h ... \mbox{$n$ times}  h(z)))  = h_n(z)
\]</span></p></li>
</ul>
<p>exercise: write out <span class="math inline">\(h_2(z) = h(h(z))\)</span> for
<span class="math display">\[
  h(z) =     p_0 + p_1 z + p_2 z^2.
  \]</span>}</p>
</div>
</div>
<div id="extinction" class="section level2">
<h2><span class="header-section-number">3.6</span> Extinction</h2>
<p>-[``Extinction is forever.’’] So, the probability <span class="math inline">\(d_n\)</span> of extinction
{} generation <span class="math inline">\(n\)</span> can never decline over time. (Must it
always rise?)</p>
<p>Recursive extinction</p>
<p>-[Is non-extinction ``forever’’?] If <span class="math inline">\(\lim_{n \rightarrow \infty} = d(\infty) &lt;  1\)</span>, then this says there’s a chance <span class="math inline">\(1 - d(\infty)\)</span> of eternal
persistence. We’ll try to figure out more about what this means.</p>
<p>If the probability of a female line going extinct in <span class="math inline">\(n\)</span> generations
is <span class="math inline">\(d_n\)</span>, then this is equivalent to her daughter(s) line(s) going
extinct in <span class="math inline">\(n-1\)</span> generations. With <span class="math inline">\(p_k\)</span> chance of having
<span class="math inline">\(k\)</span> daughters, we have
<span class="math display">\[
  d_n = p_0 + p_1 d_{n-1} + \mbox{What is next term in series?}
  \]</span></p>
<p>What can we do with
<span class="math display">\[
  d_n = h(d_{n-1})?
  \]</span></p>
<p>Well, remember that <span class="math inline">\(d_n\)</span> is non-decreasing, and that it’s maximum
can be no greater than <span class="math inline">\(1.0\)</span>. When <span class="math inline">\(d_n\)</span> reaches it’s limit, say
<span class="math inline">\(d\)</span>, we won’t need generational subscripts, <span class="math inline">\(d\)</span> will be constant,
and will obey
<span class="math display">\[
  d = h(d)
  \]</span></p>
<p>Thus, an amazing result: the probability of ultimate extinction
is when the argument equals the PGF of the argument.</p>
<p>Can <span class="math inline">\(d = 1\)</span>, can <span class="math inline">\(d &lt; 1\)</span></p>
<ul>
<li>Try <span class="math inline">\(d = 1\)</span>. What happens?</li>
<li>If we were to find a solution less than 1.0, how would we
interpret that?</li>
</ul>
<p>Three cases</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">  <span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="dt">pty =</span> <span class="st">&quot;s&quot;</span>)</a>
<a class="sourceLine" id="cb25-2" data-line-number="2">  z =<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">1.6</span>, <span class="fl">.01</span>)</a>
<a class="sourceLine" id="cb25-3" data-line-number="3">  pk =<span class="st"> </span><span class="kw">c</span>(.<span class="dv">3</span>, <span class="fl">.0</span>, <span class="fl">.7</span>); <span class="kw">names</span>(pk) &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb25-4" data-line-number="4">  d &lt;-<span class="st"> </span>pk[<span class="st">&quot;0&quot;</span>]</a>
<a class="sourceLine" id="cb25-5" data-line-number="5">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb25-6" data-line-number="6">  {</a>
<a class="sourceLine" id="cb25-7" data-line-number="7">      d &lt;-<span class="st"> </span>pk[<span class="st">&quot;0&quot;</span>]  <span class="op">+</span><span class="st"> </span>pk[<span class="st">&quot;1&quot;</span>]<span class="op">*</span>d <span class="op">+</span><span class="st"> </span>pk[<span class="st">&quot;2&quot;</span>]<span class="op">*</span>d<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb25-8" data-line-number="8">  }</a>
<a class="sourceLine" id="cb25-9" data-line-number="9">  <span class="co">##  super-critical </span></a>
<a class="sourceLine" id="cb25-10" data-line-number="10">  hz =<span class="st"> </span>pk[<span class="st">&quot;0&quot;</span>]  <span class="op">+</span><span class="st"> </span>pk[<span class="st">&quot;1&quot;</span>]<span class="op">*</span>z <span class="op">+</span><span class="st"> </span>pk[<span class="st">&quot;2&quot;</span>]<span class="op">*</span>z<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb25-11" data-line-number="11">  plot.fun &lt;-<span class="st"> </span><span class="cf">function</span>(z, hz)</a>
<a class="sourceLine" id="cb25-12" data-line-number="12">  {</a>
<a class="sourceLine" id="cb25-13" data-line-number="13">      <span class="kw">plot</span>(z, hz, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">1.6</span>),</a>
<a class="sourceLine" id="cb25-14" data-line-number="14">           <span class="dt">ylab =</span> <span class="st">&quot;h(z)&quot;</span>,</a>
<a class="sourceLine" id="cb25-15" data-line-number="15">           <span class="dt">yaxs =</span> <span class="st">&quot;i&quot;</span>, <span class="dt">xaxs =</span> <span class="st">&quot;i&quot;</span>, <span class="dt">axes =</span> F)</a>
<a class="sourceLine" id="cb25-16" data-line-number="16">      <span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">1.5</span>, <span class="fl">.5</span>))</a>
<a class="sourceLine" id="cb25-17" data-line-number="17">      <span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">at =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">1.5</span>, <span class="fl">.5</span>))</a>
<a class="sourceLine" id="cb25-18" data-line-number="18">      <span class="kw">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)</a>
<a class="sourceLine" id="cb25-19" data-line-number="19">      <span class="kw">lines</span>(z, hz)</a>
<a class="sourceLine" id="cb25-20" data-line-number="20">      <span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">at =</span> pk[<span class="st">&quot;0&quot;</span>], <span class="dt">labels =</span> <span class="st">&quot;p0&quot;</span>,</a>
<a class="sourceLine" id="cb25-21" data-line-number="21">           <span class="dt">col.axis =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>,</a>
<a class="sourceLine" id="cb25-22" data-line-number="22">           <span class="dt">lwd =</span> <span class="dv">1</span>, <span class="dt">las =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb25-23" data-line-number="23">  }</a>
<a class="sourceLine" id="cb25-24" data-line-number="24">  <span class="kw">plot.fun</span>(z,hz)</a>
<a class="sourceLine" id="cb25-25" data-line-number="25">  <span class="kw">points</span>(<span class="kw">c</span>(d, <span class="dv">1</span>),<span class="kw">c</span>(d, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb25-26" data-line-number="26">  <span class="kw">title</span>(<span class="st">&quot;Super-critical (m &gt; 1) </span><span class="ch">\n</span><span class="st"> 2 roots&quot;</span>)</a>
<a class="sourceLine" id="cb25-27" data-line-number="27">  <span class="co">## sub-critical</span></a>
<a class="sourceLine" id="cb25-28" data-line-number="28">  pk =<span class="st"> </span><span class="kw">c</span>(.<span class="dv">3</span>, <span class="fl">.55</span>, <span class="fl">.15</span>); <span class="kw">names</span>(pk) &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb25-29" data-line-number="29">  hz =<span class="st"> </span>pk[<span class="st">&quot;0&quot;</span>]  <span class="op">+</span><span class="st"> </span>pk[<span class="st">&quot;1&quot;</span>]<span class="op">*</span>z <span class="op">+</span><span class="st"> </span>pk[<span class="st">&quot;2&quot;</span>]<span class="op">*</span>z<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb25-30" data-line-number="30">  <span class="kw">plot.fun</span>(z,hz)</a>
<a class="sourceLine" id="cb25-31" data-line-number="31">  <span class="kw">title</span>(<span class="st">&quot;Sub-critical (m &lt; 1) </span><span class="ch">\n</span><span class="st"> 1 root&quot;</span>)</a>
<a class="sourceLine" id="cb25-32" data-line-number="32">  <span class="kw">points</span>(<span class="dv">1</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb25-33" data-line-number="33">  <span class="co">## critical</span></a>
<a class="sourceLine" id="cb25-34" data-line-number="34">  pk =<span class="st"> </span><span class="kw">c</span>(.<span class="dv">3</span>, <span class="fl">.4</span>, <span class="fl">.3</span>); <span class="kw">names</span>(pk) &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb25-35" data-line-number="35">  hz =<span class="st"> </span>pk[<span class="st">&quot;0&quot;</span>]  <span class="op">+</span><span class="st"> </span>pk[<span class="st">&quot;1&quot;</span>]<span class="op">*</span>z <span class="op">+</span><span class="st"> </span>pk[<span class="st">&quot;2&quot;</span>]<span class="op">*</span>z<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb25-36" data-line-number="36">  <span class="kw">plot.fun</span>(z, hz)</a>
<a class="sourceLine" id="cb25-37" data-line-number="37">  <span class="kw">title</span>(<span class="st">&quot;Critical (m = 1), </span><span class="ch">\n</span><span class="st"> 1 root&quot;</span>)</a>
<a class="sourceLine" id="cb25-38" data-line-number="38">  <span class="kw">points</span>(<span class="dv">1</span>,<span class="dv">1</span>)</a></code></pre></div>
<p><img src="07-branching_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>We can prove by answering:
What is <span class="math inline">\(h&#39;(1)\)</span>? What is <span class="math inline">\(h(0)\)</span>? Is <span class="math inline">\(h&#39;&#39;(z) &gt; 0\)</span>?</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1">  pk =<span class="st"> </span><span class="kw">c</span>(.<span class="dv">3</span>, <span class="fl">.0</span>, <span class="fl">.7</span>); <span class="kw">names</span>(pk) &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb26-2" data-line-number="2">  z =<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">1.6</span>, <span class="fl">.01</span>)</a>
<a class="sourceLine" id="cb26-3" data-line-number="3">  hz =<span class="st"> </span>pk[<span class="st">&quot;0&quot;</span>]  <span class="op">+</span><span class="st"> </span>pk[<span class="st">&quot;1&quot;</span>]<span class="op">*</span>z <span class="op">+</span><span class="st"> </span>pk[<span class="st">&quot;2&quot;</span>]<span class="op">*</span>z<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb26-4" data-line-number="4">  <span class="kw">plot.fun</span>(z,hz)</a></code></pre></div>
<p><img src="07-branching_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Where is <span class="math inline">\(h(p_0)\)</span>, <span class="math inline">\(h(h(p_0))\)</span>, <span class="math inline">\(h(h(h(p_0)))\)</span>, <span class="math inline">\(\ldots\)</span>?</p>
<p>So how do we actually get <span class="math inline">\(d\)</span>?</p>
<p>Take the case where <span class="math inline">\(p_0 = .3\)</span>, <span class="math inline">\(p_1 = 0\)</span>, and <span class="math inline">\(p_3 = .7\)</span> (the one I
just plotted).</p>
<ul>
<li>Can do some algebra </li>
<li>Or we can recursively iterate on the computer.</li>
</ul>
<p>Numerical recursion</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">  pk =<span class="st"> </span><span class="kw">c</span>(.<span class="dv">3</span>, <span class="fl">.0</span>, <span class="fl">.7</span>); <span class="kw">names</span>(pk) &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">2</span> <span class="co">## our example</span></a>
<a class="sourceLine" id="cb27-2" data-line-number="2">  d &lt;-<span class="st"> </span>pk[<span class="st">&quot;0&quot;</span>] <span class="co"># initial value</span></a>
<a class="sourceLine" id="cb27-3" data-line-number="3">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">20</span>)</a>
<a class="sourceLine" id="cb27-4" data-line-number="4">  {</a>
<a class="sourceLine" id="cb27-5" data-line-number="5">      d &lt;-<span class="st"> </span>pk[<span class="st">&quot;0&quot;</span>]  <span class="op">+</span><span class="st"> </span>pk[<span class="st">&quot;1&quot;</span>]<span class="op">*</span>d <span class="op">+</span><span class="st"> </span>pk[<span class="st">&quot;2&quot;</span>]<span class="op">*</span>d<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb27-6" data-line-number="6">      <span class="cf">if</span> (i <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">19</span>,<span class="dv">20</span>))</a>
<a class="sourceLine" id="cb27-7" data-line-number="7">          <span class="kw">print</span>(<span class="kw">paste</span>(i, d))</a>
<a class="sourceLine" id="cb27-8" data-line-number="8">  }</a></code></pre></div>
<pre><code>## [1] &quot;1 0.363&quot;
## [1] &quot;2 0.3922383&quot;
## [1] &quot;19 0.428565882081349&quot;
## [1] &quot;20 0.428568100698915&quot;</code></pre>
<p>Did we get the right value?</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1">  pk =<span class="st"> </span><span class="kw">c</span>(.<span class="dv">3</span>, <span class="fl">.0</span>, <span class="fl">.7</span>); <span class="kw">names</span>(pk) &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb29-2" data-line-number="2">  z =<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">1.6</span>, <span class="fl">.01</span>)</a>
<a class="sourceLine" id="cb29-3" data-line-number="3">  hz =<span class="st"> </span>pk[<span class="st">&quot;0&quot;</span>]  <span class="op">+</span><span class="st"> </span>pk[<span class="st">&quot;1&quot;</span>]<span class="op">*</span>z <span class="op">+</span><span class="st"> </span>pk[<span class="st">&quot;2&quot;</span>]<span class="op">*</span>z<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb29-4" data-line-number="4">  <span class="kw">plot.fun</span>(z,hz)</a>
<a class="sourceLine" id="cb29-5" data-line-number="5">  <span class="kw">abline</span>(<span class="dt">h =</span> d, <span class="dt">col =</span> <span class="st">&quot;green&quot;</span>)</a>
<a class="sourceLine" id="cb29-6" data-line-number="6">  <span class="kw">abline</span>(<span class="dt">v =</span> d, <span class="dt">col =</span> <span class="st">&quot;green&quot;</span>)</a></code></pre></div>
<p><img src="07-branching_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>Extinction and non-extinction revisited</p>
<ul>
<li>If <span class="math inline">\(m &gt; 1\)</span>, there exists <span class="math inline">\(d\)</span> bigger than 0 and less than unity.</li>
<li>This means there’s some positive chance of extinction.</li>
<li>But also some chance of never-extinction. (What form does
never-extinction take?)</li>
</ul>
</div>
<div id="return-to-our-simulation" class="section level2">
<h2><span class="header-section-number">3.7</span> Return to our simulation</h2>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1">    <span class="kw">suppressWarnings</span>(<span class="kw">matplot</span>(<span class="kw">t</span>(Z.mat), <span class="dt">log =</span> <span class="st">&quot;y&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">ylab =</span> <span class="st">&quot;Zn&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;n&quot;</span>))</a></code></pre></div>
<p><img src="07-branching_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>Relevance to Corona virus?</p>
<div id="means-and-variances-of-z_n" class="section level3">
<h3><span class="header-section-number">3.7.1</span> Means and variances of <span class="math inline">\(Z_n\)</span>}</h3>
<p>We’ll skip for now, maybe come back to with Fisher-Wright.</p>
</div>
<div id="convergence-of-z_n-mn-to-random-variable-w" class="section level3">
<h3><span class="header-section-number">3.7.2</span> Convergence of <span class="math inline">\(Z_n / m^n\)</span> to random variable <span class="math inline">\(W\)</span>}</h3>
<p>We’ll also skip.</p>
</div>
</div>
<div id="good-and-bad-set-ups-for-branching-process" class="section level2">
<h2><span class="header-section-number">3.8</span> Good and bad set-ups for branching process</h2>
<ul>
<li>Bad</li>
<li>When offspring of 1 depends on offspring of other (e.g.,
brothers inheriting a farm)</li>
<li>When resource constraints slow growth rates (e.g.,
Malthus: fertility of next gen depends on fertility of last;
SIR model in disease spread)</li>
<li>Analysis. PGF is powerful but still we often have to deal
with listing all possibilities.</li>
<li>Big populations – law of large numbers means randomness
doesn’t matter.</li>
<li><p>Good</p></li>
<li>Unrestricted growth (frontier, new disease, start of a
reaction)</li>
<li>A ``null’’ model for understanding how apparent structure
is just random outcomes. Families that die out didn’t have to
have low <span class="math inline">\(NRR\)</span>. Just because most new viruses don’t break out,
doesn’t mean they aren’t potentially dangerous (<span class="math inline">\(R_0 &gt;&gt; 1.0\)</span>).</li>
<li><p>A model that corresponds our mental model of running a
generative process forward. (cf. Fisher-Wright)</p></li>
</ul>
</div>
</div>
<!--bookdown:body:end-->
            </section>

          </div>
        </div>
      </div>
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
    </div>
  </div>
<!--bookdown:config-->

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
